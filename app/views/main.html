<!--The main panel of the application-->
<core-header-panel flex>

  <!--The top navigation bar-->
  <core-toolbar id="mainheader">
    <paper-icon-button id="navicon" icon="menu" ng-click="showSidebar = !showSidebar"></paper-icon-button>
    <paper-dropdown-menu label="{{activeProject.name}}" id="projectSelection">
      <paper-dropdown class="dropdown">
        <core-selector>
          <paper-item ng-repeat="project in projects" value="{{project.name}}" ng-click="selectProj(project)">{{project.name}}</paper-item>
        </core-selector>
      </paper-dropdown>
    </paper-dropdown-menu>
    <span flex></span>

    <!--Open Notifications button and div-->
    <paper-icon-button icon="social:notifications-none" ng-click="isNotificationsOpen = !isNotificationsOpen"></paper-icon-button>
    <div id="NotificationDiv" ng-show="isNotificationsOpen">
      <p>Here will be notifications</p>
    </div>

    <!--Open Profile button and div-->
    <paper-icon-button src="https://dl.dropboxusercontent.com/u/42434834/FakeProfilePic.jpg" ng-click="isProfileOpen = !isProfileOpen"></paper-icon-button>
    <div id="profileDiv" ng-show="isProfileOpen">
      <div id="profileDivContent" style="margin: 12px">
        <p>{{activeUser.firstname}} {{activeUser.lastname}}</p>
        <p style="color: #808080; font-size: small">{{activeUser.email}}</p>
        <p style="color: #808080; font-size: small">Is admin : {{activeUser.admin}}</p>
      </div>
      <div id="profileDivFooter">
        <paper-button ng-click="editProfile()">Edit</paper-button>
        <paper-button ng-click="signOut()">Sign Out</paper-button>
      </div>
    </div>
  </core-toolbar>

  <div id="containerMain">
    <!--The side bar of the application / component selection-->
    <div id="sidebar" ng-show="!showSidebar" style="position: absolute;width: 195px;background-color: white;z-index: 10">
      <!--Create a new component-->
      <paper-button ng-click="showCreateCompDiv=!showCreateCompDiv" style="display: block;">
        <core-icon icon="icons:add-circle" style="padding-right: 5px"></core-icon>
        Component
      </paper-button>
      <div ng-hide="!showCreateCompDiv" style="background-color: white;margin-bottom: 20px">
        <paper-input-decorator label="Name">
          <paper-autogrow-textarea>
            <textarea ng-model="newCompName"></textarea>
          </paper-autogrow-textarea>
        </paper-input-decorator>
        <paper-input-decorator label="Description">
          <paper-autogrow-textarea>
            <textarea ng-model="newCompDesc"></textarea>
          </paper-autogrow-textarea>
        </paper-input-decorator>
        <paper-icon-button ng-click="submitNewComponent()" icon="icons:check"></paper-icon-button>
        <paper-icon-button ng-click="clearComponentSubmit()" icon="icons:clear"></paper-icon-button>
      </div>
      <!--Show component list-->
      <core-menu id="componentSelection">
        <paper-item ng-repeat="component in components" ng-click="selectComp(component)">{{component.name}}</paper-item>
      </core-menu>
    </div>


    <!--The main content panel-->
    <div class="content">
      <!--Currently selected component-->
      <!--For some reason I cannot more the style attr to main.css-->
      <div id="currentComponent" style="display: -webkit-box;display: -moz-box;width: -moz-available;">
        <div style="width: 80%">
          <h2 ng-bind="activeComponent.name"></h2>
          <p ng-bind="activeComponent.description"></p>
        </div>
        <div style="width: 20%">
          <p style="font-size: small">Component lead:</p>
          <p>
            <span ng-bind="componentLeader.firstName"></span>
            <span ng-bind="componentLeader.lastName"></span>
          </p>
          <paper-icon-button icon="icons:add-circle" ng-click="showCreateReqDiv=!showCreateReqDiv"></paper-icon-button>
          <paper-icon-button icon="editor:mode-edit"></paper-icon-button>
          <paper-icon-button icon="icons:delete" ng-click="initDeleteComponent()"></paper-icon-button>
        </div>
      </div>
      <div ng-hide="!showCreateReqDiv" style="background-color: white;margin-bottom: 20px">
        <p>Add requirement</p>
        <paper-input-decorator label="Name">
          <paper-autogrow-textarea>
            <textarea ng-model="newReqName"></textarea>
          </paper-autogrow-textarea>
        </paper-input-decorator>
        <paper-input-decorator label="Description">
          <paper-autogrow-textarea>
            <textarea ng-model="newReqDesc"></textarea>
          </paper-autogrow-textarea>
        </paper-input-decorator>
        <paper-icon-button ng-click="submitNewReq()" icon="icons:check"></paper-icon-button>
        <paper-icon-button ng-click="clearReqSubmit()" icon="icons:clear"></paper-icon-button>
      </div>

      <!--List representing the requirements-->
      <div ng-repeat="req in requirements">
        <paper-item style="background: white; font-size: large" ng-click="toggleComponent($event,req)">{{req.title}}</paper-item>
        <core-collapse data-visible = 'false'>
          <div class="collapse-content" style="display: -webkit-box; background-color: white">
            <div style="width: 80%">
              <p>{{req.description}}</p>
              <p>Leader : {{req.leadDeveloper.firstName}} {{req.leadDeveloper.lastName}}</p>
              <div style="background-color: #00b3ee">
                <p>People who follow the project are</p>
                <p ng-repeat="follower in req.followers">
                  {{follower.firstName}}
                </p>
              </div>
              <div style="background-color: #0f9d58">
                <p>Developers for the project</p>
                <p ng-repeat="dev in req.developers">
                  {{dev.firstName}}
                </p>
              </div>
              <p>Created by : {{req.creator.firstName}} {{req.creator.lastName}}</p>
              <paper-button ng-click="toggleAttachments($event)">Attachments</paper-button>
              <core-collapse>
                Here be attachments
                {{req.attachments}}
              </core-collapse>
              </br>
              <paper-button ng-click="toggleComments($event)">Comments</paper-button>
              <core-collapse>
                Here be comments
                {{req.comments}}
              </core-collapse>
            </div>

            <!--Sidebar for the individal requirements-->
            <div style="width: 20%">
              <paper-icon-button icon="icons:more-vert" ng-click="show=!show" style="float: right;"></paper-icon-button>
              <div ng-hide="!show">
                <paper-button style="width: 100%">Become Lead</paper-button>
                <paper-icon-button icon="icons:favorite" ng-click="followRequirement($event,req)"></paper-icon-button>
                <paper-icon-button icon="editor:mode-edit"></paper-icon-button>
                <paper-icon-button icon="icons:thumb-up"></paper-icon-button>
                <paper-icon-button icon="icons:thumb-down"></paper-icon-button>
                <paper-icon-button icon="icons:delete"></paper-icon-button>
              </div>
            </div>
          </div>
        </core-collapse>
        </br>
      </div>

    </div>
  </div>



  <!--Pop-up elements-->
  <paper-action-dialog id="deleteSomething" heading="Dialog Title" transition="core-transition-center" ng-show="warningVisible">
    <paper-shadow z="1">
      <p>{{warningText}}</p>
      <paper-button affirmative ng-click="resetDeleteComponent()">Decline</paper-button>
      <paper-button affirmative ng-click="deleteComponent()">Accept</paper-button>
    </paper-shadow>
  </paper-action-dialog>

</core-header-panel>
